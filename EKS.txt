--------------------------------------------------------------------
EFS

Crear EFS con VPC_PRINCIPAL y cambiar accesos a grupo_seguridad_servidor
Con este comando en Attach (Mount via IP), lo ponemos en nuestra maquina
(tarda un poco)

cp -rpv /var/EKS-SYMFONY/MyWall/. efs/

find . -name ".env"
find . -name "vendor"

----------------------------------------------------------------------------------------------------------------------------------------------
EKS 

# Instalar kubectl
curl -LO "https://dl.k8s.io/release/v1.31.1/bin/linux/amd64/kubectl"
chmod +x ./kubectl
mkdir -p $HOME/bin && cp ./kubectl $HOME/bin/kubectl && export PATH=$PATH:$HOME/bin

# Instalar eksctl
curl -Lo eksctl_Linux_amd64.tar.gz https://github.com/weaveworks/eksctl/releases/latest/download/eksctl_Linux_amd64.tar.gz
tar -xzf eksctl_Linux_amd64.tar.gz -C /tmp && rm eksctl_Linux_amd64.tar.gz
sudo mv /tmp/eksctl /usr/local/bin

aws configure

nano ~/.aws/credentials
nano ~/.aws/config

aws_access_key_id = 
aws_secret_access_key = 
aws_session_token = IQoJb3JpZ2luX2VjEK7//////////wEaCXVzLXdlc3QtMiJIMEYCIQDOtylu5BbM1neq+W3U0DjQ/haF0FWBZJVj5wD0dAaL1wIhAOu8ODwTh2r1yZzdw92cwk3azKmcRo4ryfWf7+PjBRs+KrACCHcQABoMMTE5MzczNzMxMjQ1IgwSgauIvT96bqrBHjkqjQLokpLTlrg9Q5qRsZjTQSHo7ZzI8iXz+kWuTUHxUrGGRjilyujdrxtKjhXSj6qdmHuFiGuWkgV8CK3VcWbfuoMa7w4HYeUlCw2G9LKEtCnHyAGgjwlJKu+Wqnexf/wFu3eUbjlBdbXV7EB8Bb54trjKCR9B7IrAynrpICA9H5UJymuKl78++zNyBOi2fT3o2XibQ7fFIEfn2R/xoHNpDnxBHFlU2sU6UWxutsfP1AVA/bOM+XSRpxYWkZqeOsCeQ9UGWhYtIXS59M0SL/M9ld3OvOfKJm1jBBUz3jekJ2Vi03RroDS4Qc1/5qF22QnbsOINFmJ1ywPfTVpVUj/LemQh6G2rAzeyJd5xtGY4ZDDDqdzBBjqcAX3eqbXL+Ezj2jsEkv8E+3T4w+wbCc6LUu7py0NoRPX0WctabuJgqay1ug4XuI77+qoSd7/unaTbEMOSc8uqPOVo+VOVblmTXNrjXMJtom4L1YSe/7N654r+sEsgPlgZrDK46OQtSF+0x3i34q9zhP/lOconposNrgcWLKqw+6JJbX60cnS8mOo6AssZKJPPsElmLl5aulunrZH2fQ==

# Ver si lo encuentra
eksctl get cluster

#Ver status del cluster
aws eks update-kubeconfig --name AulaSyncCluster --region us-east-1

# Desplegar el backend
kubectl apply -f backend.yml

# Desplegar el frontend
kubectl apply -f front.yml

# Ver nodos
kubectl get nodes

kubectl get pods
kubectl get svc

kubectl describe pods
kubectl describe svc

# Para la subred en us-east-1a
aws ec2 create-tags \
  --resources subnet-0afe1ef93ddf0ee0e \
  --tags Key=kubernetes.io/cluster/AulaSyncCluster,Value=shared \
         Key=kubernetes.io/role/elb,Value=1

# Para la subred en us-east-1b
aws ec2 create-tags \
  --resources subnet-0d22cb7dde6e8ccd2 \
  --tags Key=kubernetes.io/cluster/AulaSyncCluster,Value=shared \
         Key=kubernetes.io/role/elb,Value=1


kubectl exec -it php-apache-55d99fc54b-nqj2h -- /bin/bash

composer install --no-dev --optimize-autoloader

mkdir -p /var/www/html/var/cache/prod
mkdir -p /var/www/html/var/log
chmod -R 777 /var/www/html/var/cache
chmod -R 777 /var/www/html/var/log
chown -R root:root /var/www/html/var

# PÃ¢ra comprobar si el loadBalancer funciona
for i in {1..10}; do curl -s -w "%{remote_ip}\n" -o /dev/null http://www.mywall-eks.work.gd./ ; done

kubectl run test-pod --image=busybox --restart=Never --rm -it -- /bin/sh
wget -qO- http://172.20.231.111


--------------------------------------------------------------------------------------------------------------------------------------